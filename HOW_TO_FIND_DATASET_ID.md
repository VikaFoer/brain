# Як знайти Dataset ID для Rada Open Data Portal

## Метод 1: Через веб-інтерфейс (найпростіший)

### Крок 1: Відкрийте портал відкритих даних
Перейдіть на: **https://data.rada.gov.ua/ogd/**

### Крок 2: Знайдіть dataset з нормативно-правовими актами
Шукайте dataset з назвами типу:
- "Нормативно-правові акти"
- "Закони України"
- "База даних НПА"
- "Законодавство України"

### Крок 3: Відкрийте сторінку dataset
Натисніть на назву dataset, щоб відкрити його сторінку.

### Крок 4: Знайдіть ID в URL
Після відкриття сторінки dataset, подивіться на URL браузера. Він має виглядати приблизно так:

```
https://data.rada.gov.ua/open/data/12345
```

Число в кінці URL (у прикладі `12345`) - це і є **Dataset ID**.

Або URL може бути:
```
https://data.rada.gov.ua/ogd/12345
```

### Крок 5: Скопіюйте ID
Скопіюйте це число - це ваш `RADA_OPEN_DATA_DATASET_ID`.

---

## Метод 2: Через API (автоматичний пошук)

Система автоматично намагається знайти dataset ID, але якщо це не вдається, ви можете використати тестовий endpoint:

### Використання тестового endpoint

```bash
# Через curl
curl https://ваш-домен.railway.app/api/legal-acts/test-open-data-api

# Або через браузер
https://ваш-домен.railway.app/api/legal-acts/test-open-data-api
```

Цей endpoint:
1. Намагається знайти dataset ID автоматично
2. Показує знайдений ID (якщо вдалося)
3. Показує приклад NREGs з цього dataset

---

## Метод 3: Через каталог JSON

### Крок 1: Отримайте каталог
Відкрийте в браузері:
```
https://data.rada.gov.ua/ogd/registry.json
```

Або:
```
https://data.rada.gov.ua/open/main/registry.json
```

### Крок 2: Знайдіть dataset
У JSON файлі шукайте об'єкт з полями `title` або `name`, що містять:
- "нормативно-правові акти"
- "законодавство"
- "нпа"
- "закони"

### Крок 3: Витягніть ID
У знайденому об'єкті шукайте поле:
- `id`
- `guid`
- `identifier`
- `dataset_id`

Це і є ваш Dataset ID.

---

## Метод 4: Через інспекцію HTML

### Крок 1: Відкрийте портал
Відкрийте https://data.rada.gov.ua/ogd/ в браузері

### Крок 2: Відкрийте DevTools
Натисніть `F12` або `Ctrl+Shift+I`

### Крок 3: Знайдіть посилання
У вкладці "Elements" або "Елементи" знайдіть посилання на dataset з нормативно-правовими актами.

Посилання має виглядати так:
```html
<a href="/open/data/12345">Нормативно-правові акти</a>
```

Число `12345` в `href` - це Dataset ID.

---

## Встановлення Dataset ID в Railway

### Крок 1: Відкрийте Railway Dashboard
Перейдіть на https://railway.app і відкрийте ваш проект.

### Крок 2: Відкрийте Settings
Натисніть на ваш сервіс → "Settings" (або "Налаштування")

### Крок 3: Додайте змінну
1. Знайдіть секцію "Variables" (або "Змінні")
2. Натисніть "New Variable" (або "Нова змінна")
3. Введіть:
   - **Name**: `RADA_OPEN_DATA_DATASET_ID`
   - **Value**: `<ваш_dataset_id>` (наприклад, `12345`)
4. Натисніть "Add" (або "Додати")

### Крок 4: Перезапустіть сервіс
Після додавання змінної Railway автоматично перезапустить сервіс.

---

## Перевірка, чи працює Dataset ID

### Через API endpoint

```bash
curl https://ваш-домен.railway.app/api/legal-acts/test-open-data-api
```

У відповіді має бути:
```json
{
  "status": "success",
  "dataset_id": "12345",
  "nregs_count": 1000,
  "sample_nregs": ["254к/96-вр", "123/45-аб", ...]
}
```

### Через логи Railway

Перевірте логи Railway - мають зникнути помилки типу:
- ❌ "Could not find legal acts dataset ID"
- ✅ Має з'явитися: "Using manually configured dataset ID: 12345"

---

## Альтернатива: Якщо Dataset ID не знайдено

Якщо ви не можете знайти dataset ID або його не існує, система автоматично використає fallback методи:

1. **HTML парсинг** - парсить сторінки `/laws/main/r` для отримання списку НПА
2. **New documents list** - отримує нові документи за останні 1-3 роки
3. **Updated documents list** - отримує оновлені документи

Ці методи працюють навіть без dataset ID, але можуть бути повільнішими.

---

## Troubleshooting

### Проблема: "Could not find legal acts dataset ID"

**Рішення:**
1. Перевірте, чи правильно вказано `RADA_OPEN_DATA_DATASET_ID` в Railway
2. Переконайтеся, що ID існує на порталі
3. Спробуйте оновити ID (можливо, він змінився)

### Проблема: Dataset ID знайдено, але NREGs не отримуються

**Рішення:**
1. Перевірте формат dataset - має бути JSON або CSV
2. Перевірте структуру даних - має містити поле з NREG
3. Перевірте логи для деталей помилки

### Проблема: Dataset ID працює локально, але не на Railway

**Рішення:**
1. Переконайтеся, що змінна `RADA_OPEN_DATA_DATASET_ID` додана в Railway
2. Перезапустіть сервіс після додавання змінної
3. Перевірте, що змінна видима в логах (не має бути `None`)

---

## Корисні посилання

- **Портал відкритих даних**: https://data.rada.gov.ua/ogd/
- **Документація API**: https://data.rada.gov.ua/open/main/api/page2
- **Railway Variables**: https://railway.app (Settings → Variables)

---

## Приклад знайденого Dataset ID

Якщо ви знайшли dataset з назвою "База даних нормативно-правових актів" і URL:
```
https://data.rada.gov.ua/open/data/12345678
```

То ваш `RADA_OPEN_DATA_DATASET_ID` = `12345678`

Додайте це в Railway:
```
RADA_OPEN_DATA_DATASET_ID=12345678
```

І система автоматично почне використовувати цей dataset для отримання списку всіх НПА.

