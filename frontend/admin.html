<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Legal Graph System</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/frontend/admin.css">
    <script>
        // Fallback if CSS doesn't load
        document.addEventListener('DOMContentLoaded', () => {
            try {
                const body = document.body;
                if (body && (!document.querySelector('link[href*="admin.css"]') || !getComputedStyle(body).getPropertyValue('--primary'))) {
                    const link = document.createElement('link');
                    link.rel = 'stylesheet';
                    link.href = '/frontend/admin.css';
                    document.head.appendChild(link);
                }
            } catch (e) {
                // Silently fail if body doesn't exist yet
                console.debug('CSS fallback check skipped:', e);
            }
        });
    </script>
</head>
<body>
    <div class="container">
        <div class="main-content">
            <!-- Sidebar -->
            <aside class="sidebar">
                <section class="actions">
                    <h2>‚ö° –î—ñ—ó</h2>
                    <button id="refresh-btn" class="btn btn-primary">
                        <span>üîÑ</span> –û–Ω–æ–≤–∏—Ç–∏ —Å–ø–∏—Å–æ–∫
                    </button>
                    <button id="process-new-btn" class="btn btn-success">
                        <span>‚ûï</span> –û–±—Ä–æ–±–∏—Ç–∏ –Ω–æ–≤–∏–π –∞–∫—Ç
                    </button>
                    <button id="auto-download-btn" class="btn btn-info">
                        <span>üì•</span> –ê–≤—Ç–æ–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è 10 –∞–∫—Ç—ñ–≤
                    </button>
                </section>

                <section class="filters">
                    <h2>üîç –§—ñ–ª—å—Ç—Ä–∏</h2>
                    <label>
                        <input type="checkbox" id="processed-only" checked>
                        –¢—ñ–ª—å–∫–∏ –æ–±—Ä–æ–±–ª–µ–Ω—ñ
                    </label>
                    <label>
                        <input type="text" id="search-input" placeholder="üîé –ü–æ—à—É–∫ –ø–æ –Ω–∞–∑–≤—ñ...">
                    </label>
                </section>

                <section class="stats">
                    <h2>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
                    <div id="stats-content">
                        <div class="stat-item">
                            <span class="stat-label">–í—Å—å–æ–≥–æ –∞–∫—Ç—ñ–≤:</span>
                            <span class="stat-value" id="total-acts">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">–û–±—Ä–æ–±–ª–µ–Ω–æ:</span>
                            <span class="stat-value" id="processed-acts">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">–ö–∞—Ç–µ–≥–æ—Ä—ñ–π:</span>
                            <span class="stat-value" id="total-categories">0</span>
                        </div>
                    </div>
                </section>
            </aside>

            <!-- Main area -->
            <main class="main-area">
                <div class="tabs">
                    <button class="tab-btn active" data-tab="acts">
                        <span>üìÑ</span> –ê–∫—Ç–∏
                    </button>
                    <button class="tab-btn" data-tab="rada-list">
                        <span>üåê</span> –í—Å—ñ –ù–ü–ê –∑ Rada
                    </button>
                    <button class="tab-btn" data-tab="categories">
                        <span>üìÅ</span> –ö–∞—Ç–µ–≥–æ—Ä—ñ—ó
                    </button>
                    <button class="tab-btn" data-tab="database">
                        <span>üóÑÔ∏è</span> –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö
                    </button>
                </div>

                <!-- Acts tab -->
                <div id="acts-tab" class="tab-content active">
                    <div id="acts-list" class="acts-list">
                        <p class="loading">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</p>
                    </div>
                </div>

                <!-- Rada list tab -->
                <div id="rada-list-tab" class="tab-content">
                    <!-- Toggle between database and API views -->
                    <div class="view-toggle" style="margin-bottom: 20px; display: flex; gap: 10px; align-items: center;">
                        <button id="view-database-btn" class="btn btn-primary view-toggle-btn active" data-view="database">
                            <span>üóÑÔ∏è</span> –ó –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
                        </button>
                        <button id="view-api-btn" class="btn btn-secondary view-toggle-btn" data-view="api">
                            <span>üåê</span> –î–æ—Å—Ç—É–ø–Ω—ñ –∑ API
                        </button>
                    </div>
                    
                    <!-- Database view (existing) -->
                    <div id="database-view" class="view-content">
                        <div class="rada-list-header">
                            <div class="rada-list-actions">
                                <button id="load-rada-list-btn" class="btn btn-secondary">
                                    <span>üîÑ</span> –û–Ω–æ–≤–∏—Ç–∏ —Å–ø–∏—Å–æ–∫ –ù–ü–ê
                                </button>
                            <button id="download-active-acts-btn" class="btn btn-primary">
                                <span>üì•</span> –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –¥—ñ—é—á—ñ –ù–ü–ê
                            </button>
                            <button id="download-active-and-process-btn" class="btn btn-success">
                                <span>‚öôÔ∏è</span> –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ç–∞ –æ–±—Ä–æ–±–∏—Ç–∏ –¥—ñ—é—á—ñ
                            </button>
                            <button id="download-from-dataset-btn" class="btn btn-warning">
                                <span>üìä</span> –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑ –¥–∞—Ç–∞—Å–µ—Ç—É (–≤—Å—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∏)
                            </button>
                            <button id="sync-all-rada-btn" class="btn btn-info">
                                <span>üìã</span> –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –≤—Å—ñ –ù–ü–ê (–±–µ–∑ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó)
                            </button>
                            <button id="process-all-overnight-btn" class="btn btn-warning">
                                <span>üåô</span> –û–±—Ä–æ–±–∏—Ç–∏ –≤—Å—ñ –ù–ü–ê –∑–∞ –Ω—ñ—á
                            </button>
                        </div>
                        <div id="rada-stats" class="rada-stats"></div>
                        <!-- Progress bar container -->
                        <div id="download-progress-container" class="download-progress-container" style="display: none;">
                            <div class="progress-info">
                                <span id="progress-text">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</span>
                                <span id="progress-percent">0%</span>
                            </div>
                            <div class="progress-bar">
                                <div id="progress-bar-fill" class="progress-bar-fill" style="width: 0%"></div>
                            </div>
                            <div class="progress-details" id="progress-details"></div>
                        </div>
                        <div id="rada-list" class="rada-list">
                            <p class="loading">–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "–û–Ω–æ–≤–∏—Ç–∏ —Å–ø–∏—Å–æ–∫ –ù–ü–ê" –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–µ—Ä–µ–ª—ñ–∫—É –≤—Å—ñ—Ö –ù–ü–ê –∑ Rada API</p>
                        </div>
                    </div>
                    
                    <!-- API view (new) -->
                    <div id="api-view" class="view-content" style="display: none;">
                        <div class="rada-list-header">
                            <div class="rada-list-actions" style="display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 20px;">
                                <select id="available-acts-type" style="padding: 10px 15px; background: var(--bg-card); border: 1px solid var(--border); color: var(--text); border-radius: 8px; font-size: 14px;">
                                    <option value="updated">üîÑ –ü–æ–Ω–æ–≤–ª–µ–Ω—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∏</option>
                                    <option value="new_today">üÜï –ù–æ–≤—ñ –∑–∞ —Å—å–æ–≥–æ–¥–Ω—ñ</option>
                                    <option value="new_30days">üìÖ –ù–æ–≤—ñ –∑–∞ 30 –¥–Ω—ñ–≤</option>
                                    <option value="all">üìã –í—Å—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∏</option>
                                </select>
                                <button id="load-available-acts-btn" class="btn btn-primary">
                                    <span>üîÑ</span> –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Å–ø–∏—Å–æ–∫
                                </button>
                                <button id="download-selected-acts-btn" class="btn btn-success" style="display: none;">
                                    <span>üì•</span> –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –≤–∏–±—Ä–∞–Ω—ñ (<span id="selected-count">0</span>)
                                </button>
                            </div>
                            <div id="available-acts-stats" class="rada-stats" style="margin-bottom: 20px;"></div>
                        </div>
                        <div id="available-acts-list" class="rada-list">
                            <p class="loading">–í–∏–±–µ—Ä—ñ—Ç—å —Ç–∏–ø —Å–ø–∏—Å–∫—É —Ç–∞ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å "–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Å–ø–∏—Å–æ–∫"</p>
                        </div>
                        <div id="available-acts-pagination" class="pagination" style="margin-top: 20px; display: none;"></div>
                    </div>
                </div>

                <!-- Categories tab -->
                <div id="categories-tab" class="tab-content">
                    <div id="categories-list" class="categories-list">
                        <p class="loading">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</p>
                    </div>
                </div>

                <!-- Database schema tab -->
                <div id="database-tab" class="tab-content">
                    <div id="database-schema" class="database-schema">
                        <p class="loading">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</p>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Modal for act details -->
    <div id="details-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-title">üìã –î–µ—Ç–∞–ª—ñ –∞–∫—Ç—É</h2>
                <button class="close-btn" id="close-modal">&times;</button>
            </div>
            <div class="modal-body" id="modal-body">
                <p class="loading">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</p>
            </div>
        </div>
    </div>

    <!-- Modal for process new act -->
    <div id="process-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚öôÔ∏è –û–±—Ä–æ–±–∏—Ç–∏ –Ω–æ–≤–∏–π –∞–∫—Ç</h2>
                <button class="close-btn" id="close-process-modal">&times;</button>
            </div>
            <div class="modal-body">
                <label>
                    –ù–æ–º–µ—Ä —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó (nreg):
                    <input type="text" id="nreg-input" placeholder="254–∫/96-–≤—Ä">
                </label>
                <div class="modal-actions">
                    <button id="start-process-btn" class="btn btn-primary">–ü–æ—á–∞—Ç–∏ –æ–±—Ä–æ–±–∫—É</button>
                    <button id="cancel-process-btn" class="btn btn-secondary">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                </div>
                <div id="process-status" class="process-status"></div>
            </div>
        </div>
    </div>

    <script src="/frontend/admin.js"></script>
</body>
</html>
